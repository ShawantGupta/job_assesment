from flask import Flask, render_template, request
import jsonify
import requests
import pickle
import numpy as np
import sklearn
from sklearn.preprocessing import StandardScaler
app = Flask(__name__)
model = pickle.load(open('job_assesment.pkl', 'rb'))
@app.route('/',methods=['GET'])
def Home():
    return render_template('index.html')

list1= [Nationality_ABW,
Nationality_AGO,
Nationality_AIA,
Nationality_ALB,
Nationality_AND,
Nationality_ARE,
Nationality_ARG,
Nationality_ARM,
Nationality_ASM,
Nationality_ATA,
Nationality_ATF,
Nationality_ATG,
Nationality_AUS,
Nationality_AUT,
Nationality_AZE,
Nationality_BEL,
Nationality_BEN,
Nationality_BGD,
Nationality_BGR,
Nationality_BHR,
Nationality_BHS,
Nationality_BIH,
Nationality_BLR,
Nationality_BOL,
Nationality_BRA,
Nationality_BRB,
Nationality_BWA,
Nationality_CAF,
Nationality_CAN,
Nationality_CHE,
Nationality_CHL,
Nationality_CHN,
Nationality_CIV,
Nationality_CMR,
Nationality_COD,
Nationality_COL,
Nationality_COM,
Nationality_CPV,
Nationality_CRI,
Nationality_CUB,
Nationality_CYM,
Nationality_CYP,
Nationality_CZE,
Nationality_DEU,
Nationality_DMA,
Nationality_DNK,
Nationality_DOM,
Nationality_DZA,
Nationality_ECU,
Nationality_EGY,
Nationality_ERI,
Nationality_ESP,
Nationality_EST,
Nationality_ETH,
Nationality_FIN,
Nationality_FJI,
Nationality_FLK,
Nationality_FRA,
Nationality_FRO,
Nationality_GAB,
Nationality_GBR,
Nationality_GEO,
Nationality_GHA,
Nationality_GIB,
Nationality_GIN,
Nationality_GNB,
Nationality_GNQ,
Nationality_GRC,
Nationality_GTM,
Nationality_GUF,
Nationality_GUY,
Nationality_HKG,
Nationality_HRV,
Nationality_HTI,
Nationality_HUN,
Nationality_IDN,
Nationality_IND,
Nationality_IOT,
Nationality_IRL,
Nationality_IRN,
Nationality_IRQ,
Nationality_ISL,
Nationality_ISR,
Nationality_ITA,
Nationality_JAM,
Nationality_JEY,
Nationality_JOR,
Nationality_JPN,
Nationality_KAZ,
Nationality_KEN,
Nationality_KGZ,
Nationality_KIR,
Nationality_KNA,
Nationality_KOR,
Nationality_KWT,
Nationality_LAO,
Nationality_LBN,
Nationality_LBY,
Nationality_LCA,
Nationality_LIE,
Nationality_LKA,
Nationality_LTU,
Nationality_LUX,
Nationality_LVA,
Nationality_MAR,
Nationality_MCO,
Nationality_MDG,
Nationality_MDV,
Nationality_MEX,
Nationality_MKD,
Nationality_MLI,
Nationality_MLT,
Nationality_MMR,
Nationality_MNE,
Nationality_MOZ,
Nationality_MRT,
Nationality_MUS,
Nationality_MWI,
Nationality_MYS,
Nationality_NAM,
Nationality_NCL,
Nationality_NGA,
Nationality_NIC,
Nationality_NLD,
Nationality_NOR,
Nationality_NPL,
Nationality_NRU,
Nationality_NZL,
Nationality_OMN,
Nationality_PAK,
Nationality_PAN,
Nationality_PCN,
Nationality_PER,
Nationality_PHL,
Nationality_PNG,
Nationality_POL,
Nationality_PRI,
Nationality_PRT,
Nationality_PRY,
Nationality_PYF,
Nationality_QAT,
Nationality_ROU,
Nationality_RUS,
Nationality_RWA,
Nationality_SAU,
Nationality_SDN,
Nationality_SEN,
Nationality_SGP,
Nationality_SLE,
Nationality_SLV,
Nationality_SMR,
Nationality_SOM,
Nationality_SPM,
Nationality_SRB,
Nationality_STP,
Nationality_SUR,
Nationality_SVK,
Nationality_SVN,
Nationality_SWE,
Nationality_SWZ,
Nationality_SYC,
Nationality_SYR,
Nationality_TCD,
Nationality_TGO,
Nationality_THA,
Nationality_TJK,
Nationality_TKM,
Nationality_TMP,
Nationality_TON,
Nationality_TUN,
Nationality_TUR,
Nationality_TWN,
Nationality_TZA,
Nationality_UGA,
Nationality_UKR,
Nationality_UMI,
Nationality_URY,
Nationality_USA,
Nationality_UZB,
Nationality_VCT,
Nationality_VEN,
Nationality_VIR,
Nationality_VNM,
Nationality_WLF,
Nationality_WSM,
Nationality_YEM,
Nationality_ZAF,
Nationality_ZWE]

list2=['ABW',
 'AGO',
 'AIA',
 'ALB',
 'AND',
 'ARE',
 'ARG',
 'ARM',
 'ASM',
 'ATA',
 'ATF',
 'ATG',
 'AUS',
 'AUT',
 'AZE',
 'BEL',
 'BEN',
 'BGD',
 'BGR',
 'BHR',
 'BHS',
 'BIH',
 'BLR',
 'BOL',
 'BRA',
 'BRB',
 'BWA',
 'CAF',
 'CAN',
 'CHE',
 'CHL',
 'CHN',
 'CIV',
 'CMR',
 'COD',
 'COL',
 'COM',
 'CPV',
 'CRI',
 'CUB',
 'CYM',
 'CYP',
 'CZE',
 'DEU',
 'DMA',
 'DNK',
 'DOM',
 'DZA',
 'ECU',
 'EGY',
 'ERI',
 'ESP',
 'EST',
 'ETH',
 'FIN',
 'FJI',
 'FLK',
 'FRA',
 'FRO',
 'GAB',
 'GBR',
 'GEO',
 'GHA',
 'GIB',
 'GIN',
 'GNB',
 'GNQ',
 'GRC',
 'GTM',
 'GUF',
 'GUY',
 'HKG',
 'HRV',
 'HTI',
 'HUN',
 'IDN',
 'IND',
 'IOT',
 'IRL',
 'IRN',
 'IRQ',
 'ISL',
 'ISR',
 'ITA',
 'JAM',
 'JEY',
 'JOR',
 'JPN',
 'KAZ',
 'KEN',
 'KGZ',
 'KIR',
 'KNA',
 'KOR',
 'KWT',
 'LAO',
 'LBN',
 'LBY',
 'LCA',
 'LIE',
 'LKA',
 'LTU',
 'LUX',
 'LVA',
 'MAR',
 'MCO',
 'MDG',
 'MDV',
 'MEX',
 'MKD',
 'MLI',
 'MLT',
 'MMR',
 'MNE',
 'MOZ',
 'MRT',
 'MUS',
 'MWI',
 'MYS',
 'NAM',
 'NCL',
 'NGA',
 'NIC',
 'NLD',
 'NOR',
 'NPL',
 'NRU',
 'NZL',
 'OMN',
 'PAK',
 'PAN',
 'PCN',
 'PER',
 'PHL',
 'PNG',
 'POL',
 'PRI',
 'PRT',
 'PRY',
 'PYF',
 'QAT',
 'ROU',
 'RUS',
 'RWA',
 'SAU',
 'SDN',
 'SEN',
 'SGP',
 'SLE',
 'SLV',
 'SMR',
 'SOM',
 'SPM',
 'SRB',
 'STP',
 'SUR',
 'SVK',
 'SVN',
 'SWE',
 'SWZ',
 'SYC',
 'SYR',
 'TCD',
 'TGO',
 'THA',
 'TJK',
 'TKM',
 'TMP',
 'TON',
 'TUN',
 'TUR',
 'TWN',
 'TZA',
 'UGA',
 'UKR',
 'UMI',
 'URY',
 'USA',
 'UZB',
 'VCT',
 'VEN',
 'VIR',
 'VNM',
 'WLF',
 'WSM',
 'YEM',
 'ZAF',
 'ZWE']

standard_to = StandardScaler()
@app.route("/predict", methods=['POST'])
def predict():
    Fuel_Type_Diesel=0
    if request.method == 'POST':
        Age  = int(request.form['Age '])
        LodgingRevenue  = float(request.form['LodgingRevenue '])
        OtherRevenue  = float(request.form['OtherRevenue '])
        AverageLeadTime  = int(request.form['AverageLeadTime '])
        PersonsNights  = int(request.form['PersonsNights '])
        RoomNights  = int(request.form['RoomNights '])
        DaysSinceCreation  = int(request.form['DaysSinceCreation '])
        DaysSinceLastStay  = int(request.form['DaysSinceLastStay '])
        DaysSinceFirstStay  = int(request.form['DaysSinceFirstStay '])
        SRAwayFromElevator  = int(request.form['SRAwayFromElevator '])
        SRNoAlcoholInMiniBar  = int(request.form['SRNoAlcoholInMiniBar '])
        SRQuietRoom  = int(request.form['SRQuietRoom '])
        SRHighFloor=int(request.form['SRHighFloor'])
        SRLowFloor=int(request.form['SRLowFloor'])
        SRAccessibleRoom=int(request.form['SRHighFloor'])
        SRMediumFloor=int(request.form['SRMediumFloor'])
        SRBathtub=int(request.form['SRBathtub'])
        SRShower=int(request.form['SRShower'])
        SRCrib=int(request.form['SRCrib'])
        SRKingSizeBed=int(request.form['SRKingSizeBed'])
        SRTwinBed=int(request.form['SRTwinBed'])
        SRNearElevator=int(request.form['SRNearElevator'])
        Nationality=request.form['Nationality']
        for i,k in enumerate(list2):
            if(Nationality== k):
                list1[i]=1
                list1[list1!=1]=0
                
        DistributionChannel=request.form['DistributionChannel']
        if(DistributionChannel=='Corporate'):
                DistributionChannel_Corporate=1
                DistributionChannel_Direct =0
                DistributionChannel_ElectronicDistribution=0
                DistributionChannel_TravelAgentOperator=0
        elif(DistributionChannel=='Direct'):
                DistributionChannel_Corporate=0
                DistributionChannel_Direct =1
                DistributionChannel_ElectronicDistribution=0
                DistributionChannel_TravelAgentOperator=0
        elif(DistributionChannel=='Electronic Distribution'):
                DistributionChannel_Corporate=0
                DistributionChannel_Direct =0
                DistributionChannel_ElectronicDistribution=1
                DistributionChannel_TravelAgentOperator=0  
        elif(DistributionChannel=='Travel Agent/Operator'):
                DistributionChannel_Corporate=0
                DistributionChannel_Direct =0
                DistributionChannel_ElectronicDistribution=0
                DistributionChannel_TravelAgentOperator=1   
        MarketSegment=request.form['MarketSegment']
        if(MarketSegment=='Aviation'):
                MarketSegment_Aviation=1
                MarketSegment_Complementary =0
                MarketSegment_Corporate=0
                MarketSegment_Direct=0
                MarketSegment_Groups=0
                MarketSegment_Other=0
                MarketSegment_TravelAgentOperator=0
        elif(MarketSegment=='Complementary'):
                MarketSegment_Aviation=0
                MarketSegment_Complementary =1
                MarketSegment_Corporate=0
                MarketSegment_Direct=0
                MarketSegment_Groups=0
                MarketSegment_Other=0
                MarketSegment_TravelAgentOperator=0
        elif(MarketSegment=='Corporate'):
                MarketSegment_Aviation=0
                MarketSegment_Complementary =0
                MarketSegment_Corporate=1
                MarketSegment_Direct=0
                MarketSegment_Groups=0
                MarketSegment_Other=0
                MarketSegment_TravelAgentOperator=0
        elif(MarketSegment=='Direct'):
                MarketSegment_Aviation=0
                MarketSegment_Complementary =0
                MarketSegment_Corporate=0
                MarketSegment_Direct=1
                MarketSegment_Groups=0
                MarketSegment_Other=0
                MarketSegment_TravelAgentOperator=0
        elif(MarketSegment=='Groups'):
                MarketSegment_Aviation=0
                MarketSegment_Complementary =0
                MarketSegment_Corporate=0
                MarketSegment_Direct=0
                MarketSegment_Groups=1
                MarketSegment_Other=0
                MarketSegment_TravelAgentOperator=0
        elif(MarketSegment=='Other'):
                MarketSegment_Aviation=0
                MarketSegment_Complementary =0
                MarketSegment_Corporate=0
                MarketSegment_Direct=0
                MarketSegment_Groups=0
                MarketSegment_Other=1
                MarketSegment_TravelAgentOperator=0
        elif(MarketSegment=='Travel Agent/Operator'):
                MarketSegment_Aviation=0
                MarketSegment_Complementary =0
                MarketSegment_Corporate=0
                MarketSegment_Direct=0
                MarketSegment_Groups=0
                MarketSegment_Other=0
                MarketSegment_TravelAgentOperator=1
            
        prediction=model.predict([[Nationality_ABW,
                Nationality_AGO,
                Nationality_AIA,
                Nationality_ALB,
                Nationality_AND,
                Nationality_ARE,
                Nationality_ARG,
                Nationality_ARM,
                Nationality_ASM,
                Nationality_ATA,
                Nationality_ATF,
                Nationality_ATG,
                Nationality_AUS,
                Nationality_AUT,
                Nationality_AZE,
                Nationality_BEL,
                Nationality_BEN,
                Nationality_BGD,
                Nationality_BGR,
                Nationality_BHR,
                Nationality_BHS,
                Nationality_BIH,
                Nationality_BLR,
                Nationality_BOL,
                Nationality_BRA,
                Nationality_BRB,
                Nationality_BWA,
                Nationality_CAF,
                Nationality_CAN,
                Nationality_CHE,
                Nationality_CHL,
                Nationality_CHN,
                Nationality_CIV,
                Nationality_CMR,
                Nationality_COD,
                Nationality_COL,
                Nationality_COM,
                Nationality_CPV,
                Nationality_CRI,
                Nationality_CUB,
                Nationality_CYM,
                Nationality_CYP,
                Nationality_CZE,
                Nationality_DEU,
                Nationality_DMA,
                Nationality_DNK,
                Nationality_DOM,
                Nationality_DZA,
                Nationality_ECU,
                Nationality_EGY,
                Nationality_ERI,
                Nationality_ESP,
                Nationality_EST,
                Nationality_ETH,
                Nationality_FIN,
                Nationality_FJI,
                Nationality_FLK,
                Nationality_FRA,
                Nationality_FRO,
                Nationality_GAB,
                Nationality_GBR,
                Nationality_GEO,
                Nationality_GHA,
                Nationality_GIB,
                Nationality_GIN,
                Nationality_GNB,
                Nationality_GNQ,
                Nationality_GRC,
                Nationality_GTM,
                Nationality_GUF,
                Nationality_GUY,
                Nationality_HKG,
                Nationality_HRV,
                Nationality_HTI,
                Nationality_HUN,
                Nationality_IDN,
                Nationality_IND,
                Nationality_IOT,
                Nationality_IRL,
                Nationality_IRN,
                Nationality_IRQ,
                Nationality_ISL,
                Nationality_ISR,
                Nationality_ITA,
                Nationality_JAM,
                Nationality_JEY,
                Nationality_JOR,
                Nationality_JPN,
                Nationality_KAZ,
                Nationality_KEN,
                Nationality_KGZ,
                Nationality_KIR,
                Nationality_KNA,
                Nationality_KOR,
                Nationality_KWT,
                Nationality_LAO,
                Nationality_LBN,
                Nationality_LBY,
                Nationality_LCA,
                Nationality_LIE,
                Nationality_LKA,
                Nationality_LTU,
                Nationality_LUX,
                Nationality_LVA,
                Nationality_MAR,
                Nationality_MCO,
                Nationality_MDG,
                Nationality_MDV,
                Nationality_MEX,
                Nationality_MKD,
                Nationality_MLI,
                Nationality_MLT,
                Nationality_MMR,
                Nationality_MNE,
                Nationality_MOZ,
                Nationality_MRT,
                Nationality_MUS,
                Nationality_MWI,
                Nationality_MYS,
                Nationality_NAM,
                Nationality_NCL,
                Nationality_NGA,
                Nationality_NIC,
                Nationality_NLD,
                Nationality_NOR,
                Nationality_NPL,
                Nationality_NRU,
                Nationality_NZL,
                Nationality_OMN,
                Nationality_PAK,
                Nationality_PAN,
                Nationality_PCN,
                Nationality_PER,
                Nationality_PHL,
                Nationality_PNG,
                Nationality_POL,
                Nationality_PRI,
                Nationality_PRT,
                Nationality_PRY,
                Nationality_PYF,
                Nationality_QAT,
                Nationality_ROU,
                Nationality_RUS,
                Nationality_RWA,
                Nationality_SAU,
                Nationality_SDN,
                Nationality_SEN,
                Nationality_SGP,
                Nationality_SLE,
                Nationality_SLV,
                Nationality_SMR,
                Nationality_SOM,
                Nationality_SPM,
                Nationality_SRB,
                Nationality_STP,
                Nationality_SUR,
                Nationality_SVK,
                Nationality_SVN,
                Nationality_SWE,
                Nationality_SWZ,
                Nationality_SYC,
                Nationality_SYR,
                Nationality_TCD,
                Nationality_TGO,
                Nationality_THA,
                Nationality_TJK,
                Nationality_TKM,
                Nationality_TMP,
                Nationality_TON,
                Nationality_TUN,
                Nationality_TUR,
                Nationality_TWN,
                Nationality_TZA,
                Nationality_UGA,
                Nationality_UKR,
                Nationality_UMI,
                Nationality_URY,
                Nationality_USA,
                Nationality_UZB,
                Nationality_VCT,
                Nationality_VEN,
                Nationality_VIR,
                Nationality_VNM,
                Nationality_WLF,
                Nationality_WSM,
                Nationality_YEM,
                Nationality_ZAF,
                Nationality_ZWE,
                Age,  
                LodgingRevenue,
                OtherRevenue,
                AverageLeadTime,
                PersonsNights,
                RoomNights,
                DaysSinceCreation,  
                DaysSinceLastStay,         
                DaysSinceFirstStay  ,
                SRAwayFromElevator,
                SRNoAlcoholInMiniBar ,
                SRQuietRoom,
                SRHighFloor,
                SRLowFloor,
                SRAccessibleRoom,
                SRMediumFloor,
                SRBathtub,
                SRShower,
                SRCrib ,
                SRKingSizeBed,
                SRTwinBed,
                SRNearElevator,
                DistributionChannel_Corporate,
                DistributionChannel_Direct,
                DistributionChannel_ElectronicDistribution,
                DistributionChannel_TravelAgentOperator,
                MarketSegment_Aviation,
                MarketSegment_Complementary,
                MarketSegment_Corporate,
                MarketSegment_Direct,
                MarketSegment_Groups,
                MarketSegment_Other,MarketSegment_TravelAgentOperator]])
        output=round(prediction[0],2)
        if output<0.50:
            return render_template('index.html',prediction_texts="Customer Will Not Check In")
        else:
            return render_template('index.html',prediction_text="Customer Will Check In")
    

if __name__=="__main__":
    app.run(debug=True)

